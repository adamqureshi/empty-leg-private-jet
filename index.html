<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>EMILY‚Ñ¢ ‚Äî Empty‚ÄëLeg Alerts | Fly Swift Tail</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="description" content="Tell EMILY where you are and when you can fly. Get SMS alerts for discounted empty‚Äëleg private jet flights.">
  <style>
    :root{
      --bg:#0f0f10;--panel:#161718;--ink:#eee;--muted:#a0a6ad;--line:#2a2b2d;
      --radius:14px;--pad:14px;--tap:52px;--safe:env(safe-area-inset-bottom);
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    /* Prevent horizontal jiggle */
    body{overflow-x:hidden}
    .wrap{max-width:720px;margin:0 auto;padding:24px 16px calc(96px + var(--safe));}
    header{display:flex;justify-content:space-between;align-items:center;padding:8px 0 16px;border-bottom:1px solid var(--line);margin-bottom:20px}
    .logo{font-weight:700;letter-spacing:.2px;font-size:18px}
    .pill{font-size:14px;border:1px solid var(--line);padding:8px 12px;border-radius:999px;color:#b6bcc3;display:inline-flex;gap:8px;align-items:center;min-height:44px}
    h1{font-size:30px;line-height:1.2;margin:10px 0 10px}
    p.sub{color:var(--muted);margin:0 0 20px;font-size:16px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:18px}
    .grid{display:grid;gap:16px}
    @media(min-width:540px){.grid-2{grid-template-columns:1fr 1fr;gap:16px}}
    label{display:block;font-size:14px;color:#9aa0a6;margin:0 0 8px}
    input,select,textarea,button{
      width:100%;padding:14px 16px;border-radius:12px;border:1px solid var(--line);
      background:#0b0b0c;color:var(--ink);font-size:16px;outline:none;min-height:var(--tap);
      -webkit-tap-highlight-color: transparent;
    }
    select{appearance:none;background-image:url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2224%22 height=%2224%22 fill=%22%23bfc5cc%22><path d=%22M7 10l5 5 5-5z%22/></svg>');background-repeat:no-repeat;background-position:right 12px center;padding-right:40px}
    input::placeholder,textarea::placeholder{color:#6b6f75}
    .row{display:flex;gap:10px;align-items:center}
    .row>*{flex:1}
    .hint{font-size:12px;color:#8b8f96;margin-top:6px}
    .cta{
      margin-top:10px;background:#e9e9ea;color:#111;font-weight:800;border-color:#d7d7d9;
      border-radius:14px;min-height:56px;font-size:17px;
    }
    .cta:active{transform:translateY(1px)}
    .consent{font-size:12px;color:#8b8f96;line-height:1.5;margin-top:6px}
    /* Sticky CTA that respects iOS safe-area and lifts above keyboard area */
    .sticky-cta{
      position:sticky;bottom:calc(12px + var(--safe));padding-top:16px;
      background:linear-gradient(180deg,rgba(15,15,16,0),var(--bg) 40%);
    }
    .ok{color:#a5d6a7}.warn{color:#ffd54f}.err{color:#ff8a80}
    .visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
    .foot{margin-top:12px;color:#7a7f86;font-size:12px}
    a{color:#fff;text-decoration:underline}
    /* Focus styles for accessibility */
    :focus-visible{outline:2px solid #9ecbff;outline-offset:2px;border-color:#9ecbff}
    /* When keyboard opens on mobile, unstick CTA so inputs aren't covered */
    .kb-open .sticky-cta{position:static}
    /* Bigger tap target for the location chip */
    #useGeo{min-width:140px;justify-content:center}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">Fly Swift Tail</div>
      <div class="pill" id="locStatus">üìç Location not set</div>
    </header>

    <h1>EMILY‚Ñ¢ empty‚Äëleg alerts</h1>
    <p class="sub">Tell EMILY where you can depart and when you're flexible. She‚Äôll text you available <strong>empty‚Äëlegs</strong> (often 30‚Äì70% off) that fit.</p>

    <form id="emilyForm" class="card grid" method="post" action="/api/lead" novalidate>
      <!-- spam honeypot -->
      <input type="text" name="website" class="visually-hidden" tabindex="-1" autocomplete="off">

      <div>
        <label for="origin">Home base (city or airport code)</label>
        <div class="row">
          <input id="origin" name="origin" placeholder="Ex: TEB, VNY, West Palm Beach" autocomplete="off" enterkeyhint="done">
          <button type="button" id="useGeo" class="pill">Use my location</button>
        </div>
        <div class="hint">We attach precise GPS only for matching (never shown publicly).</div>
      </div>

      <div class="grid grid-2">
        <div>
          <label for="earliest">Earliest you can go</label>
          <input type="date" id="earliest" name="earliest">
        </div>
        <div>
          <label for="latest">Latest you can go</label>
          <input type="date" id="latest" name="latest">
        </div>
      </div>

      <div class="grid grid-2">
        <div>
          <label for="seats">Seats needed</label>
          <select id="seats" name="seats" required>
            <option value="">Select‚Ä¶</option>
            <option>1</option><option>2</option><option>3</option><option>4</option><option>5+</option>
          </select>
        </div>
        <div>
          <label for="deal_target">Deal target (optional)</label>
          <select id="deal_target" name="deal_target">
            <option value="">Cheapest available</option>
            <option>Under $3k one‚Äëway</option>
            <option>Under $5k one‚Äëway</option>
            <option>Under $8k one‚Äëway</option>
          </select>
        </div>
      </div>

      <div>
        <label for="phone">Mobile (for SMS alerts)</label>
        <input id="phone" name="phone" inputmode="tel" placeholder="+1 555 123 4567" autocomplete="tel" enterkeyhint="next">
        <div class="hint">Reply STOP to opt out.</div>
      </div>

      <div>
        <label for="email">Email (optional)</label>
        <input id="email" name="email" type="email" placeholder="you@email.com" autocomplete="email" enterkeyhint="next">
      </div>

      <div>
        <label for="notes">Anything we should know?</label>
        <textarea id="notes" name="notes" rows="3" placeholder="Open to PBI/FLL/MIA; small dog; golf bags‚Ä¶" enterkeyhint="done"></textarea>
      </div>

      <!-- hidden context -->
      <input type="hidden" id="tz" name="timezone">
      <input type="hidden" id="lat" name="lat">
      <input type="hidden" id="lng" name="lng">
      <input type="hidden" id="ua" name="user_agent">
      <input type="hidden" id="utm_source" name="utm_source">
      <input type="hidden" id="utm_medium" name="utm_medium">
      <input type="hidden" id="utm_campaign" name="utm_campaign">

      <div class="consent">
        <label><input type="checkbox" id="consent" required> I agree to receive empty‚Äëleg alerts via SMS/email and to the <a href="/terms" target="_blank" rel="noopener">Terms</a> &amp; <a href="/privacy" target="_blank" rel="noopener">Privacy</a>. Msg &amp; data rates may apply.</label>
      </div>

      <div class="sticky-cta">
        <button class="cta" type="submit" id="submitBtn">Get Empty‚ÄëLeg Alerts</button>
        <div class="foot" id="formStatus" role="status" aria-live="polite"></div>
      </div>
    </form>

    <div style="margin-top:18px;color:#8b8f96;font-size:12px">Prefer predictable rates? Jet Card Exchange‚Ñ¢ coming next.</div>
  </div>

<script>
(function(){
  const qs=(s)=>document.querySelector(s);
  const status=qs('#formStatus');
  const locPill=qs('#locStatus');

  // iOS safe-area padding for full-bleed devices is handled via CSS variables above.

  const today=new Date().toISOString().split('T')[0];
  qs('#earliest').min=today; qs('#latest').min=today;

  qs('#tz').value = Intl.DateTimeFormat().resolvedOptions().timeZone || '';
  qs('#ua').value = navigator.userAgent;

  const params = new URLSearchParams(location.search);
  ['utm_source','utm_medium','utm_campaign'].forEach(k=>{ const v=params.get(k); if(v) qs('#'+k).value=v; });

  function setLoc(lat,lng){ qs('#lat').value=lat; qs('#lng').value=lng; locPill.textContent='üìç Location attached'; locPill.classList.add('ok'); }
  qs('#useGeo').addEventListener('click',()=>{
    if(!navigator.geolocation){ locPill.textContent='Location unsupported'; locPill.classList.add('warn'); return; }
    navigator.geolocation.getCurrentPosition(
      (pos)=>setLoc(pos.coords.latitude.toFixed(6),pos.coords.longitude.toFixed(6)),
      ()=>{ locPill.textContent='Location denied'; locPill.classList.add('err'); },
      {enableHighAccuracy:true,timeout:8000}
    );
  });

  function haveContact(){ return !!(qs('#phone').value.trim() || qs('#email').value.trim()); }

  // Avoid sticky CTA overlapping focused inputs: toggle .kb-open on focus
  const inputs = document.querySelectorAll('input, select, textarea');
  inputs.forEach(el=>{
    el.addEventListener('focus', ()=> document.body.classList.add('kb-open'));
    el.addEventListener('blur', ()=> setTimeout(()=>document.body.classList.remove('kb-open'), 100));
  });

  // Scroll the focused field into view on mobile for thumb reach
  inputs.forEach(el=>{
    el.addEventListener('focus', ()=>{
      setTimeout(()=>{ el.scrollIntoView({behavior:'smooth', block:'center'}); }, 50);
    });
  });

  qs('#emilyForm').addEventListener('submit', async (e)=>{
    e.preventDefault();
    status.textContent='';

    const hp=e.target.website && e.target.website.value;
    if(hp){ return; }
    if(qs('#seats').value===''){ status.textContent='Please pick seats.'; return; }
    if(!haveContact()){ status.textContent='Add a mobile or email so we can alert you.'; return; }
    if(!qs('#consent').checked){ status.textContent='Please confirm SMS/email consent.'; return; }
    const payload=Object.fromEntries(new FormData(e.target).entries());
    if(payload.earliest && payload.latest && payload.earliest>payload.latest){ status.textContent='Date window looks inverted.'; return; }

    qs('#submitBtn').disabled=true; status.textContent='Saving‚Ä¶';
    try{
      const res=await fetch(e.target.action,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
      if(!res.ok) throw new Error('Server error');
      e.target.reset(); qs('#lat').value=''; qs('#lng').value=''; locPill.textContent='üìç Location not set'; locPill.classList.remove('ok');
      status.textContent='Thanks! EMILY will text you when a matching empty‚Äëleg pops up.';
      window.scrollTo({top:0,behavior:'smooth'});
    }catch(err){
      status.textContent='Could not save right now. You can email ops@flyswifttail.com and we\'ll follow up.';
    }finally{ qs('#submitBtn').disabled=false; }
  });
})();
</script>
</body>
</html>
